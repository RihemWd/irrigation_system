{"ast":null,"code":"import { HttpParams } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class MeteoService {\n  constructor(http) {\n    this.http = http;\n    this.apiUrl = '/api/meteo';\n  }\n  // Stations\n  getAllStations() {\n    return this.http.get(`${this.apiUrl}/stations`);\n  }\n  getStationById(id) {\n    return this.http.get(`${this.apiUrl}/stations/${id}`);\n  }\n  createStation(station) {\n    return this.http.post(`${this.apiUrl}/stations`, station);\n  }\n  updateStation(id, station) {\n    return this.http.put(`${this.apiUrl}/stations/${id}`, station);\n  }\n  deleteStation(id) {\n    return this.http.delete(`${this.apiUrl}/stations/${id}`);\n  }\n  // Prévisions\n  getAllPrevisions() {\n    return this.http.get(`${this.apiUrl}/previsions/all`);\n  }\n  getPrevisions(stationId, date) {\n    const params = new HttpParams().set('stationId', stationId.toString()).set('date', date);\n    return this.http.get(`${this.apiUrl}/previsions`, {\n      params\n    });\n  }\n  createPrevision(prevision) {\n    // Transformer les données du frontend au format du backend\n    const backendPayload = {\n      date: prevision.dateDebut,\n      temperatureMax: prevision.temperatureMax,\n      temperatureMin: prevision.temperatureMin,\n      pluiePrevue: prevision.pluiePrevue,\n      vent: prevision.vent,\n      station: {\n        id: prevision.stationId // Créer un objet station avec juste l'id\n      }\n    };\n\n    return this.http.post(`${this.apiUrl}/previsions`, backendPayload);\n  }\n  updatePrevision(id, prevision) {\n    return this.http.put(`${this.apiUrl}/previsions/${id}`, prevision);\n  }\n  deletePrevision(id) {\n    return this.http.delete(`${this.apiUrl}/previsions/${id}`);\n  }\n  static {\n    this.ɵfac = function MeteoService_Factory(t) {\n      return new (t || MeteoService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: MeteoService,\n      factory: MeteoService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"mappings":"AACA,SAAqBA,UAAU,QAAQ,sBAAsB;;;AA2B7D,OAAM,MAAOC,YAAY;EAGvBC,YAAoBC,IAAgB;IAAhB,SAAI,GAAJA,IAAI;IAFhB,WAAM,GAAG,YAAY;EAEU;EAEvC;EACAC,cAAc;IACZ,OAAO,IAAI,CAACD,IAAI,CAACE,GAAG,CAAY,GAAG,IAAI,CAACC,MAAM,WAAW,CAAC;EAC5D;EAEAC,cAAc,CAACC,EAAU;IACvB,OAAO,IAAI,CAACL,IAAI,CAACE,GAAG,CAAU,GAAG,IAAI,CAACC,MAAM,aAAaE,EAAE,EAAE,CAAC;EAChE;EAEAC,aAAa,CAACC,OAAgB;IAC5B,OAAO,IAAI,CAACP,IAAI,CAACQ,IAAI,CAAU,GAAG,IAAI,CAACL,MAAM,WAAW,EAAEI,OAAO,CAAC;EACpE;EAEAE,aAAa,CAACJ,EAAU,EAAEE,OAAgB;IACxC,OAAO,IAAI,CAACP,IAAI,CAACU,GAAG,CAAU,GAAG,IAAI,CAACP,MAAM,aAAaE,EAAE,EAAE,EAAEE,OAAO,CAAC;EACzE;EAEAI,aAAa,CAACN,EAAU;IACtB,OAAO,IAAI,CAACL,IAAI,CAACY,MAAM,CAAO,GAAG,IAAI,CAACT,MAAM,aAAaE,EAAE,EAAE,CAAC;EAChE;EAEA;EACAQ,gBAAgB;IACd,OAAO,IAAI,CAACb,IAAI,CAACE,GAAG,CAAc,GAAG,IAAI,CAACC,MAAM,iBAAiB,CAAC;EACpE;EAEAW,aAAa,CAACC,SAAiB,EAAEC,IAAY;IAC3C,MAAMC,MAAM,GAAG,IAAIpB,UAAU,EAAE,CAC5BqB,GAAG,CAAC,WAAW,EAAEH,SAAS,CAACI,QAAQ,EAAE,CAAC,CACtCD,GAAG,CAAC,MAAM,EAAEF,IAAI,CAAC;IACpB,OAAO,IAAI,CAAChB,IAAI,CAACE,GAAG,CAAc,GAAG,IAAI,CAACC,MAAM,aAAa,EAAE;MAAEc;IAAM,CAAE,CAAC;EAC5E;EAEAG,eAAe,CAACC,SAAoB;IAClC;IACA,MAAMC,cAAc,GAAG;MACrBN,IAAI,EAAEK,SAAS,CAACE,SAAS;MACzBC,cAAc,EAAEH,SAAS,CAACG,cAAc;MACxCC,cAAc,EAAEJ,SAAS,CAACI,cAAc;MACxCC,WAAW,EAAEL,SAAS,CAACK,WAAW;MAClCC,IAAI,EAAEN,SAAS,CAACM,IAAI;MACpBpB,OAAO,EAAE;QACPF,EAAE,EAAEgB,SAAS,CAACN,SAAS,CAAC;;KAE3B;;IACD,OAAO,IAAI,CAACf,IAAI,CAACQ,IAAI,CAAY,GAAG,IAAI,CAACL,MAAM,aAAa,EAAEmB,cAAc,CAAC;EAC/E;EAEAM,eAAe,CAACvB,EAAU,EAAEgB,SAAoB;IAC9C,OAAO,IAAI,CAACrB,IAAI,CAACU,GAAG,CAAY,GAAG,IAAI,CAACP,MAAM,eAAeE,EAAE,EAAE,EAAEgB,SAAS,CAAC;EAC/E;EAEAQ,eAAe,CAACxB,EAAU;IACxB,OAAO,IAAI,CAACL,IAAI,CAACY,MAAM,CAAO,GAAG,IAAI,CAACT,MAAM,eAAeE,EAAE,EAAE,CAAC;EAClE;;;uBA3DWP,YAAY;IAAA;EAAA;;;aAAZA,YAAY;MAAAgC,SAAZhC,YAAY;MAAAiC,YAFX;IAAM;EAAA","names":["HttpParams","MeteoService","constructor","http","getAllStations","get","apiUrl","getStationById","id","createStation","station","post","updateStation","put","deleteStation","delete","getAllPrevisions","getPrevisions","stationId","date","params","set","toString","createPrevision","prevision","backendPayload","dateDebut","temperatureMax","temperatureMin","pluiePrevue","vent","updatePrevision","deletePrevision","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\HP\\Desktop\\alternance\\itbs_3\\microservices\\irrigation-system\\frontend\\irrigation-ui\\src\\app\\services\\meteo.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\n\r\nexport interface Station {\r\n  id?: number;\r\n  nom: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  fournisseur: string;\r\n}\r\n\r\nexport interface Prevision {\r\n  id?: number;\r\n  stationId?: number;\r\n  dateDebut?: string;\r\n  dateFin?: string;\r\n  date?: string;\r\n  temperatureMax: number;\r\n  temperatureMin: number;\r\n  pluiePrevue: number;\r\n  vent: number;\r\n  station?: Station;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MeteoService {\r\n  private apiUrl = '/api/meteo';\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  // Stations\r\n  getAllStations(): Observable<Station[]> {\r\n    return this.http.get<Station[]>(`${this.apiUrl}/stations`);\r\n  }\r\n\r\n  getStationById(id: number): Observable<Station> {\r\n    return this.http.get<Station>(`${this.apiUrl}/stations/${id}`);\r\n  }\r\n\r\n  createStation(station: Station): Observable<Station> {\r\n    return this.http.post<Station>(`${this.apiUrl}/stations`, station);\r\n  }\r\n\r\n  updateStation(id: number, station: Station): Observable<Station> {\r\n    return this.http.put<Station>(`${this.apiUrl}/stations/${id}`, station);\r\n  }\r\n\r\n  deleteStation(id: number): Observable<void> {\r\n    return this.http.delete<void>(`${this.apiUrl}/stations/${id}`);\r\n  }\r\n\r\n  // Prévisions\r\n  getAllPrevisions(): Observable<Prevision[]> {\r\n    return this.http.get<Prevision[]>(`${this.apiUrl}/previsions/all`);\r\n  }\r\n\r\n  getPrevisions(stationId: number, date: string): Observable<Prevision[]> {\r\n    const params = new HttpParams()\r\n      .set('stationId', stationId.toString())\r\n      .set('date', date);\r\n    return this.http.get<Prevision[]>(`${this.apiUrl}/previsions`, { params });\r\n  }\r\n\r\n  createPrevision(prevision: Prevision): Observable<Prevision> {\r\n    // Transformer les données du frontend au format du backend\r\n    const backendPayload = {\r\n      date: prevision.dateDebut, // Utiliser dateDebut comme date\r\n      temperatureMax: prevision.temperatureMax,\r\n      temperatureMin: prevision.temperatureMin,\r\n      pluiePrevue: prevision.pluiePrevue,\r\n      vent: prevision.vent,\r\n      station: {\r\n        id: prevision.stationId // Créer un objet station avec juste l'id\r\n      }\r\n    };\r\n    return this.http.post<Prevision>(`${this.apiUrl}/previsions`, backendPayload);\r\n  }\r\n\r\n  updatePrevision(id: number, prevision: Prevision): Observable<Prevision> {\r\n    return this.http.put<Prevision>(`${this.apiUrl}/previsions/${id}`, prevision);\r\n  }\r\n\r\n  deletePrevision(id: number): Observable<void> {\r\n    return this.http.delete<void>(`${this.apiUrl}/previsions/${id}`);\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}